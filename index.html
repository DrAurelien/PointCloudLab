<html>

<head>
	<link rel="stylesheet" type="text/css" href="style.css">
	<script id="VertexShader" type="x-shader/x-vertex">
		attribute vec3 VertexPosition;
		attribute vec3 NormalVector;
		uniform mat4 ModelView;
		uniform mat4 Projection;
		uniform mat4 ShapeTransform;
		
		varying highp vec3 Position;
		varying highp vec3 Normal;

		void main(void) {
			gl_PointSize = 5.0;
			gl_Position = Projection * ModelView * ShapeTransform * vec4(VertexPosition, 1.0);
			
			Position = VertexPosition;
			Normal = NormalVector;
		}
	</script>
	<script id="FragmentShader" type="x-shader/x-fragment">
		//Lighting model
		uniform  highp vec3 EyePosition;
		uniform  highp vec3 LightPosition;
		uniform  highp vec3 Color;
		uniform highp float DiffuseCoef;
		uniform  highp float AmbiantCoef;
		uniform  highp float SpecularCoef;
		uniform  highp float GlossyPow;
		
		varying highp vec3 Position;
		varying highp vec3 Normal;
		
		void main(void) {
			//Phong lighting
			highp vec3 eyeVect = EyePosition - Position;
			eyeVect /= length(eyeVect);
			highp vec3 lightVect = LightPosition - Position;
			lightVect /= length(lightVect);
			highp vec3 reflVec = (2.0 * dot(Normal, lightVect) * Normal)-lightVect;
			reflVec /= length(reflVec);
			
			highp float lightingCoef = ( AmbiantCoef +
				max(DiffuseCoef * dot(Normal, lightVect), 0.0) +
				max(SpecularCoef * pow(dot(eyeVect, reflVec), GlossyPow), 0.0)
				) / (AmbiantCoef+DiffuseCoef+SpecularCoef);
			gl_FragColor = vec4(Color * lightingCoef, 1);
		}
	</script>
	<!--MATHS-->
	<script type="text/javascript" src="maths/vector.js"></script>
	<script type="text/javascript" src="maths/matrix.js"></script>
	<!-- RENDERING-->
	<script type="text/javascript" src="opengl/materials.js"></script>
	<script type="text/javascript" src="opengl/renderer.js"></script>
	<!-- SHAPES -->
	<script type="text/javascript" src="shapes/shapes.js"></script>
	<script type="text/javascript" src="shapes/sphere.js"></script>
	<script type="text/javascript" src="shapes/cylinder.js"></script>
	<!--INTERFACE-->
	<script type="text/javascript" src="interface/controls.js"></script>
	<script type="text/javascript" src="interface/datahandler.js"></script>
	<script type="text/javascript" src="interface/interface.js"></script>
	<script type="text/javascript">
		var Scene =
		{
			objects : [
				//new Sphere(new Vector( [.0,.0,.0]), 2.0),
				//new Cylinder(new Vector([-3, 0, 0]), new Vector([1, 1, 1]), 0.5, 2)
			],
			
			Draw : function(drawingContext)
			{
				for(index=0; index<this.objects.length; index++)
				{
					this.objects[index].Draw(drawingContext);
				}
			}
		};
	</script>
</head>

<body onload="Interface.Initialize(Scene);">
</body>

</html>